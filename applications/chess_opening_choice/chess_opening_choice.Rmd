---
title: "R Notebook"
output: html_notebook
editor_options:
  chunk_output_type: console
---

```{r}
#library("RprobitB")
```

## Data preparation

```{r data}
data("choice_chess_opening")
choice_chess_opening$rating_diff <- choice_chess_opening$rating_w - choice_chess_opening$rating_b
choice_chess_opening$sex_w <- as.numeric(choice_chess_opening$sex_w)
data <- prepare_data(
  form = w1 ~ 0 | sex_w + byear_w + rating_w + rating_diff, 
  choice_data = choice_chess_opening, 
  id = "fideid_w",
  idc = "fideid_b",
  alternatives = c("e4","d4","Nf3","c4"),
  standardize = c("byear_w","rating_w","rating_diff")
)
```

```{r plot-data}
plot(data, by_choice = TRUE)
```

## Fixed effect model

```{r mod_fix}
mod_fix <- mcmc(data)
coef(mod_fix)
```

## Random effect model

```{r mod_re}
mod_re <- nested_model(mod_fix, 
                       re = c("sex_w","byear_w","rating_w","rating_diff"))
coef(mod_re)
round(cov_mix(mod_re, cor = TRUE),2)
```

## Cluster model

```{r mod_cl}
mod_cl <- nested_model(mod_re, 
                       latent_classes = list("C" = 2))
coef(mod_cl)
cov_mix(mod_cl, cor = TRUE)
```

## Model selection

```{r mod_selection}
x <- model_selection(mod_fix, mod_re, mod_cl)
```
