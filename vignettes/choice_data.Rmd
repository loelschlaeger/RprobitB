---
title: "Choice data"
author: "Lennart OelschlÃ¤ger"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Choice data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This vignette explains how to handle choice data in RprobitB. We use the [Train dataset from the mlogit package](https://cran.r-project.org/package=mlogit) for illustration.

```{r setup}
library(RprobitB)
```

## Characteristics and requirements of choice data

Choice data basically consists of

1. an identifier for each decider and optionally for each choice situation (which is only relevant in the panel context),

2. the choices in each choice situation,

3. alternative and decider specific covariates for each choice situation.


Therefore, RprobitB requests the following requirements to provided choice data:

1. It must be a data frame.

2. It must be in "wide" format, i.e. each row represents one choice occasion.

3. It must contain a column with unique identifier for each decision maker. 

4. It can contain a column with identifier for each choice situation, which must be unique given the decider. If this information is missing, these identifier are generated by the appearence of the columns in the data set. 

5. It can contain a column with the observed choices. Such a column is required for model fitting but not for prediction.

6. It must contain columns for the values of each alternative specific covariate for each alternative and for each decider specific covariate.


We can check that the Train dataset fulfills these requirements:

```{r overview Train data}
data("Train", package = "mlogit")
str(Train)
```

It is a data frame, each row represents one choice occasion, the columns `id` and `choiceid` identify the deciders and the choice occasions, respectively. The column `choice` gives the observed choices. We see four alternative-specific covariates, namely `price`, `time`, `change` and `comfort`. There values are given for each alternative.

## Specify the model formula

We have to tell RprobitB which covariates we want to include in our model. This is done by specifying a `formula` object.

## The `prepare` function in RprobitB

## Simulate choice data in RprobitB

## Standardize covariates

## Summarizes data
