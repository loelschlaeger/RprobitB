<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function approximates the model's marginal likelihood via different
approximation methods."><title>Approximation of the model's marginal likelihood — mml • RprobitB</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Approximation of the model's marginal likelihood — mml"><meta property="og:description" content="This function approximates the model's marginal likelihood via different
approximation methods."><meta property="og:image" content="https://loelschlaeger.de/RprobitB/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RprobitB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/RprobitB.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/v01_model_definition.html">Model definition</a>
    <a class="dropdown-item" href="../articles/v02_choice_data.html">Choice data</a>
    <a class="dropdown-item" href="../articles/v03_model_fitting.html">Model fitting</a>
    <a class="dropdown-item" href="../articles/v04_model_selection.html">Model selection</a>
    <a class="dropdown-item" href="../articles/v05_choice_prediction.html">Choice prediction</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/loelschlaeger/RprobitB/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Approximation of the model's marginal likelihood</h1>
      <small class="dont-index">Source: <a href="https://github.com/loelschlaeger/RprobitB/blob/HEAD/R/bayes_factor.R" class="external-link"><code>R/bayes_factor.R</code></a></small>
      <div class="d-none name"><code>mml.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function approximates the model's marginal likelihood via different
approximation methods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">mml</span><span class="op">(</span>
  <span class="va">x</span>,
  S <span class="op">=</span> <span class="fl">100</span>,
  method <span class="op">=</span> <span class="st">"pame"</span>,
  print_progress <span class="op">=</span> <span class="cn">TRUE</span>,
  check_conv <span class="op">=</span> <span class="cn">TRUE</span>,
  ncores <span class="op">=</span> <span class="fl">1</span>,
  seq <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>An object of class <code>RprobitB_fit</code>.</p></dd>
<dt>S</dt>
<dd><p>The sample size.</p></dd>
<dt>method</dt>
<dd><p>The approximation method, one of</p><ul><li><p><code>"pame"</code> for the prior arithmetic mean estimate,</p></li>
<li><p><code>"phme"</code> for the posterior harmonic mean estimate.</p></li>
</ul></dd>
<dt>print_progress</dt>
<dd><p>Set to <code>TRUE</code> to print computation progress.</p></dd>
<dt>check_conv</dt>
<dd><p>Set to <code>TRUE</code> to plot the convergence behavior of the approximation.</p></dd>
<dt>ncores</dt>
<dd><p>Computation is parallelized, set the number of cores.</p></dd>
<dt>seq</dt>
<dd><p>Set to <code>TRUE</code> to add the attribute <code>"seq"</code> to the output
which is a vector containing the approximation sequence.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The model's marginal likelihood value.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The model's marginal likelihood \(p(y\mid M)\) for a model \(M\) and data
\(y\) is required for the computation of Bayes factors. In general, the term
has no closed form and must be approximated numerically. This function offers
the following approximation methods. The strong law of large numbers garantees
(almost surely), that the following approximations converge to the model's
marginal likelihood as the sample size <code>S</code> goes to infinity.</p><div class="section">
<h3 id="the-prior-arithmetic-mean-estimator">The prior arithmetic mean estimator<a class="anchor" aria-label="anchor" href="#the-prior-arithmetic-mean-estimator"></a></h3>


<p>Set <code>method = "pame"</code> to compute the prior arithmetic mean estimate.
For this approach, <code>S</code> samples \(\theta_1,\dots,\theta_S\)
are drawn from the model's prior distribution. Then,
$$p(y\mid M) = \mathbb{E}_\text{prior} p(y\mid \theta,M) \approx \frac{1}{S}
\sum_s p(y\mid \theta_n,M)$$.</p>
</div>

<div class="section">
<h3 id="the-posterior-harmonic-mean-estimator">The posterior harmonic mean estimator<a class="anchor" aria-label="anchor" href="#the-posterior-harmonic-mean-estimator"></a></h3>


<p>Set <code>method = "pame"</code> to compute the posterior harmonic mean estimate.
For this approach, <code>S</code> samples \(\theta_1,\dots,\theta_S\)
are drawn from the model's posterior distribution. Then,
$$p(y\mid M) = \left(\mathbb{E}_\text{posterior} p(y\mid \theta,M)^{-1}
\right)^{-1} \approx \left( \frac{1}{S} \sum_s 1/p(y\mid \theta_n,M) \right) ^{-1}$$.</p>
</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_choices.html">simulate_choices</a></span><span class="op">(</span></span>
<span class="r-in">  form <span class="op">=</span> <span class="va">choice</span> <span class="op">~</span> <span class="va">cov</span> <span class="op">|</span> <span class="fl">0</span>,</span>
<span class="r-in">  N <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">  T <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">  J <span class="op">=</span> <span class="fl">2</span>,</span>
<span class="r-in">  seed <span class="op">=</span> <span class="fl">1</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="mcmc.html">mcmc</a></span><span class="op">(</span><span class="va">data</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 10 of 1000Iteration 20 of 1000Iteration 30 of 1000Iteration 40 of 1000Iteration 50 of 1000Iteration 60 of 1000Iteration 70 of 1000Iteration 80 of 1000Iteration 90 of 1000Iteration 100 of 1000Iteration 110 of 1000Iteration 120 of 1000Iteration 130 of 1000Iteration 140 of 1000Iteration 150 of 1000Iteration 160 of 1000Iteration 170 of 1000Iteration 180 of 1000Iteration 190 of 1000Iteration 200 of 1000Iteration 210 of 1000Iteration 220 of 1000Iteration 230 of 1000Iteration 240 of 1000Iteration 250 of 1000Iteration 260 of 1000Iteration 270 of 1000Iteration 280 of 1000Iteration 290 of 1000Iteration 300 of 1000Iteration 310 of 1000Iteration 320 of 1000Iteration 330 of 1000Iteration 340 of 1000Iteration 350 of 1000Iteration 360 of 1000Iteration 370 of 1000Iteration 380 of 1000Iteration 390 of 1000Iteration 400 of 1000Iteration 410 of 1000Iteration 420 of 1000Iteration 430 of 1000Iteration 440 of 1000Iteration 450 of 1000Iteration 460 of 1000Iteration 470 of 1000Iteration 480 of 1000Iteration 490 of 1000Iteration 500 of 1000Iteration 510 of 1000Iteration 520 of 1000Iteration 530 of 1000Iteration 540 of 1000Iteration 550 of 1000Iteration 560 of 1000Iteration 570 of 1000Iteration 580 of 1000Iteration 590 of 1000Iteration 600 of 1000Iteration 610 of 1000Iteration 620 of 1000Iteration 630 of 1000Iteration 640 of 1000Iteration 650 of 1000Iteration 660 of 1000Iteration 670 of 1000Iteration 680 of 1000Iteration 690 of 1000Iteration 700 of 1000Iteration 710 of 1000Iteration 720 of 1000Iteration 730 of 1000Iteration 740 of 1000Iteration 750 of 1000Iteration 760 of 1000Iteration 770 of 1000Iteration 780 of 1000Iteration 790 of 1000Iteration 800 of 1000Iteration 810 of 1000Iteration 820 of 1000Iteration 830 of 1000Iteration 840 of 1000Iteration 850 of 1000Iteration 860 of 1000Iteration 870 of 1000Iteration 880 of 1000Iteration 890 of 1000Iteration 900 of 1000Iteration 910 of 1000Iteration 920 of 1000Iteration 930 of 1000Iteration 940 of 1000Iteration 950 of 1000Iteration 960 of 1000Iteration 970 of 1000Iteration 980 of 1000Iteration 990 of 1000Iteration 1000 of 1000</span>
<span class="r-in"><span class="fu">RprobitB</span><span class="fu">:::</span><span class="fu">mml</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, S <span class="op">=</span> <span class="fl">10</span>, method <span class="op">=</span> <span class="st">"pame"</span>, check_conv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="mml-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.36771e-13</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://loelschlaeger.de" class="external-link">Lennart Oelschläger</a>, <a href="https://de.wikipedia.org/wiki/Dietmar_Bauer" class="external-link">Dietmar Bauer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

